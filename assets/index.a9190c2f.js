import{r as a,u as b,a as m,F as w,j as n}from"./index.a2e78bea.js";import{UserContext as D}from"./UserContext.340ef284.js";import{N as U}from"./index.876dce40.js";const E="_createPostContainer_1pvt7_1",I="_formTitle_1pvt7_15",M="_inputText_1pvt7_25",R="_textArea_1pvt7_27",B="_inputFile_1pvt7_29",$="_error_1pvt7_49",s={createPostContainer:E,formTitle:I,inputText:M,textArea:R,inputFile:B,error:$},L=()=>{const{userId:d,username:f,updateUserData:g}=a.exports.useContext(D),[r,x]=a.exports.useState(null),[i,h]=a.exports.useState(null),[l,_]=a.exports.useState(null),[c,o]=a.exports.useState(null),C=b(),T=t=>{const e=t.target.files[0];P(e)},P=t=>{const e=new FileReader;e.readAsDataURL(t),e.onloadend=()=>{_(e.result)}},v=t=>{x(t.target.value)},y=t=>{h(t.target.value)},N=()=>{if(r===null)return o("Please input a title");if(i===null)return o("Please input content");if(l===null)return o("Please input an image");o(null),S(d,f,r,i,l)},S=async(t,e,F,j,A)=>{const O={userId:t,username:e,title:F,content:j,image:A};try{const u=await(await fetch(`https://memoirs.onrender.com/api/v1/users/${e}/post`,{method:"POST",body:JSON.stringify(O),headers:{"Content-Type":"application/json","X-USER-ID":t}})).json();u.Error==="Missing required parameter - file"&&o("Please upload a photo."),u.Message==="Post successfully uploaded"&&(g(e),C(`/${e}`))}catch(p){o(p)}};return m(w,{children:[n(U,{}),m("form",{className:s.createPostContainer,children:[n("p",{className:s.formTitle,children:"Post Memories or Tell Stories"}),n("input",{className:s.inputText,onChange:v,type:"text",placeholder:"Title"}),n("textarea",{className:s.textArea,onChange:y,name:"content",id:"content",cols:"30",rows:"7",placeholder:"Content"}),n("input",{className:s.inputFile,onChange:T,type:"file",name:"image"}),n("button",{onClick:N,type:"button",children:"Submit"}),c&&n("p",{className:s.error,children:c})]})]})};export{L as default};
