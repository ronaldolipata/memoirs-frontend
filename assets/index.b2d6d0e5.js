import{r as n,u as N,a as u,F as P,j as r,L as _}from"./index.a2e78bea.js";import{UserContext as C}from"./UserContext.340ef284.js";import{N as T}from"./index.876dce40.js";const j="_loginContainer_14314_1",D="_inputText_14314_15",E="_error_14314_29",a={loginContainer:j,inputText:D,error:E},L=()=>{const{appendUserDetails:m,appendUserPosts:f,appendUserId:g,appendUsername:h,appendUsernameParams:x}=n.exports.useContext(C),[l,e]=n.exports.useState(),t=n.exports.useRef(null),o=n.exports.useRef(null),v=N(),U=()=>{if(t.current.value==="")return e("Please enter your username.");if(o.current.value==="")return e("Please enter your password.");w(t.current.value,o.current.value)},w=async(c,y)=>{try{const i=await(await fetch("https://memoirs.onrender.com/api/v1/users/login",{method:"GET",headers:{"Content-Type":"application/json","X-USERNAME":c,"X-PASSWORD":y}})).json();if(i.Error==="No User found")return e("Invalid Username");if(i.Error==="Invalid password")return e("Invalid Password");if(i.Message==="Successfully logged in")try{const s=await(await fetch(`https://memoirs.onrender.com/api/v1/users/${c}?limit=6&offset=0`)).json();m(s.userDetails),f(s.userPosts),g(s.userDetails.userId),h(s.userDetails.username),x(s.userDetails.username),e(null),v(`/memoirs-frontend/${t.current.value}`)}catch(d){return e(d)}}catch(p){return e(p)}};return u(P,{children:[r(T,{}),u("form",{className:a.loginContainer,children:[r("input",{ref:t,className:a.inputText,type:"text",name:"username",placeholder:"Username"}),r("input",{ref:o,className:a.inputText,type:"password",name:"password",placeholder:"Password"}),u("div",{children:[r("button",{onClick:U,type:"button",children:"Login"}),r(_,{to:"/register",children:"Register"})]}),l&&r("p",{className:a.error,children:l})]})]})};export{L as default};
